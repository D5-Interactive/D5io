<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="D5io - Innovative Software Solutions">
    <title>D5i</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 40px 20px;
            color: white;
        }

        header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        header p {
            font-size: 1.3em;
            opacity: 0.9;
        }

        .slideshow-container {
            max-width: 900px;
            position: relative;
            margin: 40px auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .slide {
            display: none;
            padding: 60px 40px;
            text-align: center;
            animation: fadeIn 1s;
        }

        .slide.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .slide h2 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 20px;
        }

        .slide p {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 20px;
            line-height: 1.8;
        }

        .product-icon {
            font-size: 5em;
            margin-bottom: 20px;
        }

        .features {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .feature-tag {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
        }

        .dots-container {
            text-align: center;
            padding: 20px;
            background: white;
        }

        .dot {
            height: 15px;
            width: 15px;
            margin: 0 5px;
            background-color: #bbb;
            border-radius: 50%;
            cursor: pointer;
            transition: background-color 0.3s;
            border: none;
            padding: 0;
        }

        .dot.active {
            background-color: #667eea;
        }

        .dot:hover {
            background-color: #764ba2;
        }

        .prev, .next {
            cursor: pointer;
            position: absolute;
            top: 50%;
            width: auto;
            margin-top: -22px;
            padding: 16px;
            color: white;
            font-weight: bold;
            font-size: 24px;
            transition: 0.3s;
            border-radius: 0 3px 3px 0;
            user-select: none;
            background-color: rgba(0, 0, 0, 0.3);
            z-index: 10;
            border: none;
        }

        .next {
            right: 0;
            border-radius: 3px 0 0 3px;
        }

        .prev:hover, .next:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }

        footer {
            text-align: center;
            padding: 30px;
            color: white;
            margin-top: 40px;
        }

        footer a {
            color: white;
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 2em;
            }

            header p {
                font-size: 1em;
            }

            .slide {
                padding: 40px 20px;
            }

            .slide h2 {
                font-size: 1.8em;
            }

            .slide p {
                font-size: 1em;
            }

            .product-icon {
                font-size: 3em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>D5i</h1>
            <p>DevSecOps Utilities & Applications | Made for Efficiency</p>
        </header>

        <div class="slideshow-container">
            <button class="prev" onclick="changeSlide(-1)" aria-label="Previous slide">&#10094;</button>
            <button class="next" onclick="changeSlide(1)" aria-label="Next slide">&#10095;</button>

            <div id="slides-container"></div>

            <div class="dots-container" id="dots-container"></div>
        </div>

        <footer>
            <p>&copy; 2025 D5i. All rights reserved.</p>
            <p><a href="https://github.com/D5-Interactive/D5io" target="_blank">Visit us on GitHub</a></p>
        </footer>
    </div>

    <script>
        let currentSlide = 0;
        let slideInterval;
        let slidesLoaded = false;

        // Simple markdown parser for basic formatting
        function parseMarkdown(text) {
            // Convert basic markdown to HTML
            let html = text;
            
            // Bold: **text** or __text__
            html = html.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
            html = html.replace(/__(.+?)__/g, '<strong>$1</strong>');
            
            // Italic: *text* or _text_
            html = html.replace(/\*(.+?)\*/g, '<em>$1</em>');
            html = html.replace(/_(.+?)_/g, '<em>$1</em>');
            
            // Links: [text](url)
            html = html.replace(/\[(.+?)\]\((.+?)\)/g, '<a href="$2">$1</a>');
            
            // Line breaks
            html = html.replace(/\n/g, '<br>');
            
            return html;
        }

        // Parse frontmatter from markdown content
        function parseFrontmatter(content) {
            const frontmatterRegex = /^---\s*\n([\s\S]*?)\n---\s*\n([\s\S]*)$/;
            const match = content.match(frontmatterRegex);
            
            if (!match) {
                return { frontmatter: {}, body: content };
            }
            
            const frontmatterText = match[1];
            const body = match[2];
            const frontmatter = {};
            
            // Parse simple YAML-like frontmatter
            const lines = frontmatterText.split('\n');
            for (const line of lines) {
                const colonIndex = line.indexOf(':');
                if (colonIndex > -1) {
                    const key = line.substring(0, colonIndex).trim();
                    let value = line.substring(colonIndex + 1).trim();
                    
                    // Parse array values [item1, item2, item3]
                    if (value.startsWith('[') && value.endsWith(']')) {
                        value = value.substring(1, value.length - 1)
                            .split(',')
                            .map(item => item.trim());
                    }
                    
                    frontmatter[key] = value;
                }
            }
            
            return { frontmatter, body };
        }

        // Create a slide DOM element from product data
        function createSlide(product) {
            const slide = document.createElement('div');
            slide.className = 'slide';
            
            // Add product icon
            const icon = document.createElement('div');
            icon.className = 'product-icon';
            icon.textContent = product.icon || 'üì¶';
            slide.appendChild(icon);
            
            // Add title
            const title = document.createElement('h2');
            title.textContent = product.title || 'Product';
            slide.appendChild(title);
            
            // Add description (rendered markdown)
            const description = document.createElement('p');
            description.innerHTML = parseMarkdown(product.body || '');
            slide.appendChild(description);
            
            // Add features/tags
            if (product.tags && product.tags.length > 0) {
                const features = document.createElement('div');
                features.className = 'features';
                
                product.tags.forEach(tag => {
                    const tagSpan = document.createElement('span');
                    tagSpan.className = 'feature-tag';
                    tagSpan.textContent = tag;
                    features.appendChild(tagSpan);
                });
                
                slide.appendChild(features);
            }
            
            return slide;
        }

        // Load products from manifest and markdown files
        async function loadProducts() {
            try {
                // Fetch manifest
                const manifestResponse = await fetch('/products/products.json');
                if (!manifestResponse.ok) {
                    throw new Error('Failed to load products manifest');
                }
                const manifest = await manifestResponse.json();
                
                if (!manifest || manifest.length === 0) {
                    throw new Error('No products found in manifest');
                }
                
                // Load each product markdown file
                const products = [];
                for (const filename of manifest) {
                    try {
                        const response = await fetch(`/products/${filename}`);
                        if (!response.ok) {
                            console.warn(`Failed to load product: ${filename}`);
                            continue;
                        }
                        
                        const content = await response.text();
                        const { frontmatter, body } = parseFrontmatter(content);
                        
                        products.push({
                            icon: frontmatter.icon,
                            title: frontmatter.title,
                            tags: frontmatter.tags,
                            body: body.trim()
                        });
                    } catch (error) {
                        console.warn(`Error loading product ${filename}:`, error);
                    }
                }
                
                if (products.length === 0) {
                    throw new Error('No products could be loaded');
                }
                
                // Create slide elements
                const slidesContainer = document.getElementById('slides-container');
                const dotsContainer = document.getElementById('dots-container');
                
                products.forEach((product, index) => {
                    // Create slide
                    const slide = createSlide(product);
                    if (index === 0) {
                        slide.classList.add('active');
                    }
                    slidesContainer.appendChild(slide);
                    
                    // Create dot
                    const dot = document.createElement('button');
                    dot.className = 'dot';
                    if (index === 0) {
                        dot.classList.add('active');
                        dot.setAttribute('aria-current', 'true');
                    }
                    dot.setAttribute('aria-label', `Go to slide ${index + 1}`);
                    dot.onclick = () => setSlide(index);
                    dotsContainer.appendChild(dot);
                });
                
                slidesLoaded = true;
                
                // Initialize slideshow
                showSlide();
                slideInterval = setInterval(nextSlide, 5000);
                
            } catch (error) {
                console.error('Error loading products:', error);
                
                // Show fallback slide
                const slidesContainer = document.getElementById('slides-container');
                const fallbackSlide = document.createElement('div');
                fallbackSlide.className = 'slide active';
                fallbackSlide.innerHTML = `
                    <div class="product-icon">‚ö†Ô∏è</div>
                    <h2>Products Coming Soon</h2>
                    <p>We're currently updating our product catalog. Please check back later.</p>
                `;
                slidesContainer.appendChild(fallbackSlide);
            }
        }

        function showSlide() {
            if (!slidesLoaded) return;
            
            const slides = document.getElementsByClassName('slide');
            const dots = document.getElementsByClassName('dot');
            
            if (slides.length === 0) return;

            if (currentSlide >= slides.length) {
                currentSlide = 0;
            }
            if (currentSlide < 0) {
                currentSlide = slides.length - 1;
            }

            // Hide all slides and remove aria-current
            for (let i = 0; i < slides.length; i++) {
                slides[i].classList.remove('active');
                dots[i].classList.remove('active');
                dots[i].removeAttribute('aria-current');
            }

            // Show current slide and set aria-current
            slides[currentSlide].classList.add('active');
            dots[currentSlide].classList.add('active');
            dots[currentSlide].setAttribute('aria-current', 'true');
        }

        function changeSlide(n) {
            if (!slidesLoaded) return;
            currentSlide += n;
            showSlide();
            resetInterval();
        }

        function setSlide(n) {
            if (!slidesLoaded) return;
            currentSlide = n;
            showSlide();
            resetInterval();
        }

        function nextSlide() {
            if (!slidesLoaded) return;
            currentSlide++;
            showSlide();
        }

        function resetInterval() {
            clearInterval(slideInterval);
            slideInterval = setInterval(nextSlide, 5000);
        }

        function pauseSlideshow() {
            clearInterval(slideInterval);
        }

        function resumeSlideshow() {
            if (slidesLoaded) {
                slideInterval = setInterval(nextSlide, 5000);
            }
        }

        // Load products when page loads
        window.addEventListener('DOMContentLoaded', loadProducts);

        // Pause slideshow on hover or focus for accessibility (WCAG compliance)
        const slideshowContainer = document.querySelector('.slideshow-container');
        slideshowContainer.addEventListener('mouseenter', pauseSlideshow);
        slideshowContainer.addEventListener('mouseleave', resumeSlideshow);
        slideshowContainer.addEventListener('focusin', pauseSlideshow);
        slideshowContainer.addEventListener('focusout', resumeSlideshow);
    </script>
</body>
</html>
